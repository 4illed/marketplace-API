# Маркетплейс API

Проект представляет собой REST API для маркетплейса, позволяющий управлять пользователями, товарами и заказами. Данные хранятся в базе PostgreSQL, а приложение написано на Flask.

## Требования

- [Docker](https://docs.docker.com/get-docker/)
- [Docker Compose](https://docs.docker.com/compose/install/)

## Структура проекта

- **app.py** – основной файл приложения Flask.
- **Dockerfile** – описание образа для приложения.
- **docker-compose.yml** – конфигурация для запуска приложения и PostgreSQL.
- **init.sql** – SQL-скрипт для инициализации базы данных (создание таблиц и тестовых данных).
- **requirements.txt** – зависимости проекта.
- **routes/** – директория с эндпоинтами API.
- **models/** – директория с описанием моделей (пользователей, товаров, заказов и пр.).

## Инструкция по запуску через Docker Compose

1. **Сборка и запуск сервисов**

   В терминале, находясь в корне проекта, выполните команду:
   
   ```bash
   docker-compose up --build
   ```
   
   Эта команда:
   - Соберет Docker-образ для вашего приложения.
   - Запустит контейнер с PostgreSQL, используя образ `postgres:13`.
   - Смонтирует `init.sql` для инициализации базы данных (создание таблиц и вставка тестовых данных).
   - Запустит контейнер с вашим приложением Flask.

2. **Запуск в фоне**

   Чтобы запустить контейнеры в фоновом режиме, используйте флаг `-d`:
   
   ```bash
   docker-compose up --build -d
   ```

3. **Остановка и удаление контейнеров**

   Для остановки запущенных контейнеров выполните:
   
   ```bash
   docker-compose down
   ```
   
   Если есть "orphan" контейнеры, можно удалить их командой:
   
   ```bash
   docker-compose down --remove-orphans
   ```

## Доступ к приложению

После успешного запуска приложение будет доступно по адресу:

```
http://localhost:5000
```

## Инициализация БД

При первом запуске контейнера с PostgreSQL, скрипт `init.sql` автоматически выполнится, создав таблицы:
- `users`
- `products`
- `orders`
- `order_items`

а также добавит тестовые данные (например, пользователя и товар).

## Просмотр логов

Для просмотра логов контейнеров выполните:

```bash
docker-compose logs -f
```

## Примечания

- Убедитесь, что порты 5000 (приложение) и 5432 (PostgreSQL) свободны на вашем компьютере.
- При необходимости обновите параметры подключения в файле `app.py` (используется переменная окружения `DB_HOST` со значением `db` для обращения к контейнеру PostgreSQL).

Теперь вы готовы запускать и использовать API маркетплейса через Docker Compose!